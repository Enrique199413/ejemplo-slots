<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../paper-card/paper-card.html">

<dom-module id="search-bar">
  <template>
    <style>
      :host {
        display: flex;
        flex-wrap: wrap;
        --h2-color: red;
      }
      paper-card {
        border: 1px solid black;
      }

      h2 {
        color: var(--h2-color, red);
      }

      input {
        padding: 10px;
        border: none;
        box-shadow: 10px 10px 10px black;
        margin: 10px;
        @apply --search-bar-input-mixin;
      }
    </style>
    <h2>{{title}} EnriqueLC</h2>
    <input type="text" placeholder="[[searchText]]" value="{{valueForSearch::input}}" class="input" on-focus="_clickEnFocus"/>
    <button on-click="_searchData">BÃºscar</button>
    {{valueForSearch}}
    <slot></slot>
  </template>

  <script>
    /**
     * `ejemplo-slots`
     * 
     *
     * @customElement
     * @polymer
     * @demo demo/index.html
     */
    class SearchBar extends Polymer.Element {
      static get is() { return 'search-bar'; }
      static get properties() {
        return {
          items: {
            type: Array,
            value: []
          },
          valueForSearch: String,
          title: String,
          _temp: Array
        };
      }

      connectedCallback() {
        super.connectedCallback();
        this._temp = this.items;
      }

      _clickEnFocus() {
        console.log('ya le dio click al focus');
        this.dispatchEvent(new CustomEvent('search-bar-focus-event', {
          detail: 'ya le dio click al focus',
          bubbles: true,
          composed: true
        }));
      }

      _searchData() {
        this.items = this._temp.filter((item, index) => {
          const filterQuantity = item.quantity === parseInt(this.valueForSearch, 10);
          const filterName = item.name === this.valueForSearch;
          const filterDias = item.dias === parseInt(this.valueForSearch, 10);
          return filterDias || filterName || filterQuantity;
        });
        console.log(this.items, this._temp);
      }
    }

    window.customElements.define(SearchBar.is, SearchBar);
  </script>
</dom-module>
